exec tail-server-log &

exec restic init --json --option rclone.program=restic-ceph-server --option rclone.args=$TEST_ARGS --repo rclone: --password-file $WORK/password.txt
stdin stdout
exec jq '{message_type: .message_type, id: .id}'
stdin stdout
exec scrubhex - -
cmp stdout out.json

exec restic cat config --option rclone.program=restic-ceph-server --option rclone.args=$TEST_ARGS --repo rclone: --password-file $WORK/password.txt
cp stdout restic-cat-config-stdout

stdin restic-cat-config-stdout
exec scrubhex - -
cmp stdout config.txt

-- out.json --
{
  "message_type": "initialized",
  "id": "[HEX]"
}
-- password.txt --
secret
-- config.txt --
{
  "version": 2,
  "id": "[HEX]",
  "chunker_polynomial": "[HEX]"
}

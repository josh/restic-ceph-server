exec restic-ceph-server --socket $WORK/restic.sock --addr 127.0.0.1:$PORT &server&
exec wait4unix $WORK/restic.sock
exec wait4inet 127.0.0.1:$PORT

exec curl --silent --request POST http://127.0.0.1:$PORT/?create=true

exec curl --silent --request POST --data-binary @blob-data http://127.0.0.1:$PORT/data/abd9a2bf47af3416b041796843b9f9a7a5e987356da7ccfc750816219f0a075a

exec curl --silent --unix-socket $WORK/restic.sock --request GET http://localhost/data/abd9a2bf47af3416b041796843b9f9a7a5e987356da7ccfc750816219f0a075a
cmp stdout blob-data

exec curl --silent --request GET http://127.0.0.1:$PORT/data/abd9a2bf47af3416b041796843b9f9a7a5e987356da7ccfc750816219f0a075a
cmp stdout blob-data

kill server

-- blob-data --
test blob content
